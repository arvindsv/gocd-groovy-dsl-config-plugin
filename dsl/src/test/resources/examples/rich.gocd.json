{
  "target_version": 3,
  "pipelines": [
    {
      "name": "pipe2",
      "group": "rich",
      "label_template": "${mygit[:8]}",
      "lock_behavior": "lockOnFailure",
      "tracking_tool": {
        "link": "http://your-trackingtool/yourproject/${ID}",
        "regex": "evo-(\\d+)"
      },
      "timer": {
        "spec": "0 0 22 ? * MON-FRI",
        "only_on_changes": true
      },
      "materials": [
        {
          "name": "mygit",
          "type": "git",
          "url": "http://my.example.org/mygit.git",
          "branch": "ci"
        },
        {
          "name": "upstream",
          "type": "dependency",
          "pipeline": "pipe2",
          "stage": "test"
        }
      ],
      "stages": [
        {
          "name": "build",
          "clean_working_directory": true,
          "approval": {
            "type": "manual",
            "roles": [
              "manager"
            ]
          },
          "jobs": [
            {
              "name": "csharp",
              "run_instance_count": 3,
              "resources": [
                "net45"
              ],
              "artifacts": [
                {
                  "type": "build",
                  "source": "bin/",
                  "destination": "build"
                },
                {
                  "type": "test",
                  "source": "tests/",
                  "destination": "test-reports/"
                },
                {
                  "type": "external",
                  "id": "docker-release-candidate",
                  "store_id": "dockerhub",
                  "configuration": [
                    {
                      "key": "image",
                      "value": "gocd/gocd-server"
                    },
                    {
                      "key": "tag",
                      "value": "latest"
                    },
                    {
                      "key": "DB_PASSWORD",
                      "encrypted_value": "AES:yBk975e1rJiuRnAx9AZ6Og==:ee6yi/2sEh5/TUlbmNWelg=="
                    }
                  ]
                }
              ],
              "tabs": [
                {
                  "name": "report",
                  "path": "test-reports/index.html"
                }
              ],
              "environment_variables": [
                {
                  "name": "MONO_PATH",
                  "value": "/usr/bin/local/mono"
                },
                {
                  "name": "PASSWORD",
                  "encrypted_value": "AES:yBk975e1rJiuRnAx9AZ6Og==:ee6yi/2sEh5/TUlbmNWelg=="
                }
              ],
              "tasks": [
                {
                  "type": "fetch",
                  "is_source_a_file": false,
                  "pipeline": "pipe2",
                  "stage": "build",
                  "job": "test",
                  "source": "test-bin/",
                  "destination": "bin/",
                  "artifact_origin": "gocd"
                },
                {
                  "type": "exec",
                  "command": "make",
                  "arguments": [
                    "VERBOSE=true"
                  ]
                },
                {
                  "type": "exec",
                  "command": "bash",
                  "arguments": [
                    "-c",
                    "./build.sh ci"
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
